<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>PR HACKER PREMIUM</title>
<style>
  :root {
    --page-pad: 10px;            /* tashqi bo‘sh joy */
    --row-gap: 2px;              /* qatordan qatorga bo‘sh joy */
    --col-gap: 2px;              /* iconlar oralig‘i */
  }

  html, body {
    height: 100%;
  }
  body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: #000;
    color: #fff;
    overflow: hidden;
    display: grid;
    grid-template-rows: auto 1fr;
  }

  /* Orqa fon zarrachalar */
  #tsparticles {
    position: fixed; inset: 0;
    z-index: -1;
  }

  /* Status bar */
  #statusBar {
    text-align: center;
    padding: 12px 8px;
    background: rgba(0,0,0,0.5);
    font-size: 20px;
    font-weight: bold;
    user-select: none;
    white-space: nowrap;
  }

  /* Grid o‘rami */
  #gridWrap {
    display: grid;
    place-items: center;         
    padding: var(--page-pad);
  }

  /* Grid konteyner — pastdan tepaga */
  #gridContainer {
    display: grid;
    grid-template-rows: repeat(10, 1fr);
    row-gap: var(--row-gap);
    transform: rotate(180deg); /* butun grid aylantirildi */
  }

  /* Qatorlar */
  .row {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    column-gap: var(--col-gap);
    align-items: center;
    justify-items: center;
    transform: rotate(180deg); /* rasmlarni yana to‘g‘rilash */
    padding: 0;
    background: transparent;
  }

  .row span { display: none !important; }

  .row img {
    width: 28px;
    height: 28px;
    margin: 0;
    image-rendering: -webkit-optimize-contrast;
    image-rendering: crisp-edges;
    object-fit: contain;
    pointer-events: none;
    user-select: none;
  }

  .size-guard {
    max-width: 100%;
    overflow: hidden;
  }
</style>
</head>
<body>

<div id="tsparticles"></div>

<div id="statusBar">PR HACKER 15$</div>

<div id="gridWrap">
  <div id="gridContainer" class="size-guard"></div>
</div>

<!-- tsparticles -->
<script src="https://cdn.jsdelivr.net/npm/tsparticles@2/tsparticles.bundle.min.js"></script>
<script>
  tsParticles.load("tsparticles", {
    background:{ color:{ value:"#000000" } },
    particles:{
      number:{ value:100 },
      color:{ value:"#ffffff" },
      shape:{ type:"circle" },
      opacity:{ value:0.5 },
      size:{ value:3 },
      move:{ enable:true, speed:1, direction:"none", outModes:"out" },
      links:{ enable:true, color:"#66e6b3", distance:150, opacity:0.4, width:1 }
    },
    interactivity:{ events:{ onHover:{ enable:true, mode:"repulse" }, resize:true } },
    detectRetina:true
  });
</script>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
<script>
  const firebaseConfig = {
    apiKey: "AIzaSyB1_XCbC777hKwxlilhMeq5Hpty1dvDT1I",
    authDomain: "giper-8fd92.firebaseapp.com",
    databaseURL: "https://giper-8fd92-default-rtdb.firebaseio.com",
    projectId: "giper-8fd92",
    storageBucket: "giper-8fd92.appspot.com",
    messagingSenderId: "485740337398",
    appId: "1:485740337398:web:ab901fd4f28219ea5834d7"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  const USER_ID = "U8i3fi3YKeezO0rwlwqEov8kIeT2";
  const STEPS = [
    "XBET_1_23","XBET_1_54","XBET_1_93","XBET_2_41",
    "XBET_4_02","XBET_6_71","XBET_11_18","XBET_27_92",
    "XBET_69_93","XBET_349_68"
  ];

  const container = document.getElementById("gridContainer");
  const rows = [];

  for (let i = 0; i < STEPS.length; i++) {
    const row = document.createElement("div");
    row.classList.add("row");

    for (let j = 0; j < 5; j++) {
      const img = document.createElement("img");
      img.src = "img/hidden.png";
      row.appendChild(img);
    }

    container.appendChild(row);
    rows.push(row);
  }

  const coerceBool = (v) => (typeof v === 'boolean') ? v :
    (typeof v === 'string' ? v.trim().toLowerCase() === 'true' : false);
  const boolToImg = (t) => t ? 'img/appleHealthy.png' : 'img/appleRotten.png';

  STEPS.forEach((stepKey, index) => {
    db.ref(`${stepKey}/${USER_ID}`).on("value", (snap) => {
      const v = snap.val() || {};
      const arr = [
        coerceBool(v.apple1),
        coerceBool(v.apple2),
        coerceBool(v.apple3),
        coerceBool(v.apple4),
        coerceBool(v.apple5)
      ];
      const imgs = rows[index].querySelectorAll("img");
      arr.forEach((val, i) => { imgs[i].src = boolToImg(val); });
    });
  });

  function sizeToFit() {
    const statusBar = document.getElementById('statusBar');
    const pagePad = 10;
    const rowGap = 2;
    const colGap = 2;
    const availH = window.innerHeight - statusBar.offsetHeight - (pagePad * 2);
    const availW = window.innerWidth - (pagePad * 2);
    const rowsCount = STEPS.length;
    const colsCount = 5;

    const totalRowGaps = (rowsCount - 1) * rowGap;
    const rowHeight = Math.floor((availH - totalRowGaps) / rowsCount);

    const totalColGaps = (colsCount - 1) * colGap;
    const iconWFromWidth = Math.floor((availW - totalColGaps) / colsCount);

    const iconSize = Math.max(12, Math.min(rowHeight, iconWFromWidth));
    const containerWidth = (iconSize * colsCount) + totalColGaps;
    container.style.width = containerWidth + 'px';
    container.style.gridTemplateRows = `repeat(${rowsCount}, ${iconSize}px)`;
    container.style.rowGap = rowGap + 'px';

    rows.forEach(r => {
      r.style.gridTemplateColumns = `repeat(${colsCount}, ${iconSize}px)`;
      r.style.columnGap = colGap + 'px';
      r.querySelectorAll('img').forEach(img => {
        img.style.width = iconSize + 'px';
        img.style.height = iconSize + 'px';
      });
    });
  }

  window.addEventListener('resize', sizeToFit);
  window.addEventListener('orientationchange', sizeToFit);
  sizeToFit();
</script>

</body>
</html>